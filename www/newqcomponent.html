<html>
<head>
<title>How to create a new question component</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<style type="text/css">
.codesample {
    border: 1px solid #369;
    background: #eee;
    padding: 1em;
}
</style>
</head>
<body>

<h1>How to create a new question component</h1>

<h2>Overview</h2>
	
<p>
	New question components should probably be created in the package <code>om.stdcomponent</code>. 
	To develop a question component  a new class that is a subclass of <code>om.stdquestion.QComponent</code> is 
	required. These are typically called <code>SomethingTypeComponent.java</code>.
	In addition to the <code>SomethingTypeComponent.java</code> file, you may also have one or 
	both of a <code>SomethingTypeComponent.js</code> and a <code>SomethingTypeComponent.css</code> file for 
	Javascript and styles. If either of these exist, the question engine 
	automatically processes them for you.
</p>
	
<p>
	e.g. the RadioBoxComponent has java, javascript and css files.
</p>
<ul>
	<li><code>RadioBoxComponent.java</code> -  
		The java file contains the code for initialising, rendering and handling student inputs.</li>
	<li><code>RadioBoxComponent.js</code> - 
		The javascript file typically contains event handling for student interaction with 
		the component on the webpage. For the RadioBoxComponent it handles the onClick event 
		for the radiobox</li>
	<li><code>RadioBoxComponent.css</code> - 
		Adds styles and alignment information for the radiobox.</li>	
</ul>

<p>
	To add a component to Openmark you will need to edit the 
	<code>om.stdcomponent.ComponentRegistry</code>.  The new class should be 
	added to the COMPONENTCLASSES array (alphabetical order has been used).
</p>
	
<p>
	Once you have created the files that you need , <code>SomethingTypeComponent .java, .js, .css</code> 
	and added the component to the Component registry you will need  to implement the 
	functionality of your new question component. There are four parts to this 
	outlined in the sections below.	
</p>
	

<h2>Initialisation</h2>

	<p>Your component will require a tag name for use in the question.xml.</p>
	
	<p>e.g. from the IndentComponent</p>
	
	<pre class="codesample">
		/** @return Tag name (introspected; this may be replaced by a 1.5 annotation) */
		public static String getTagName()
		{
			return "indent";
		}
	</pre>	
	

<p><strong>Adding parameters</strong></p>
	<p>
		<code>QComponent</code> has the method defineProperties() that is intended 
		for overriding. As default it is set to allow an 'id', 'display'(true)  
		and 'enabled'(true). If you require more properties then override this 
		method, remembering to call the superclass if you want to keep the defaults.
	</p>
	
	<p>
		e.g. Your component requires a highlight property and you want to set 
		the initial/default value to false.
	</p>
	
	<pre class="codesample">
		/** Property name for being highlighted (boolean) */
		public static final String PROPERTY_HIGHLIGHT="highlight";
		@Override
		protected void defineProperties() throws OmDeveloperException
		{
			super.defineProperties();
			defineBoolean(PROPERTY_HIGHLIGHT);
			setBoolean(PROPERTY_HIGHLIGHT,false);
		}
	</pre>

<p><strong>init</strong></p>
	
	<p>
		As part of the initialisation <code>QComponent</code> init calls 
		initChildren(Element eThis). This initialises children 
		based on the given XML element.	
	</p>
		
	<p>
		The default implementation treats all child elements as components. 
		If you want to include text as well or treat elements differently 
		(i.e. your component will have it's own internal tags with a specific meaning) 
		you will need  to override this method.
	</p>
	
	<p>
		You want to include text
	</p>
	
	<p>
		e.g. from the text component
	</p>
	
	<pre class="codesample">
		@Override
		protected void initChildren(Element eThis) throws OmException
		{
			getQDocument().buildInsideWithText(this,eThis);
		}
	</pre>
	
	<p>
		You do not want your component to have any child elements
	</p>
	
	<p>
		e.g. from the gap component
	</p>
	
	<pre class="codesample">
		@Override
		protected void initChildren(Element eThis) throws OmException
		{
			if(eThis.getFirstChild()!=null) throw new OmFormatException(
				"<gap> may not contain other content");
		}	
	</pre>
		
	<p>
		for examples of components with their own internal tags that are not components see the 
		<code>DropdownComponent, EquationComponent, TableComponent, WordselectComponent</code>.
	</p>

<h2>Rendering</h2>

<p>produce visible output.</p>

<p>resources.</p>

<h2>Recieving the student's response</h2>

<p>...</p>

<h2>An interface for quesion authors</h2>

<p>...</p>

</body>
</html>
